<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper 
    PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
    "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
    
<mapper namespace="shareword">
	<parameterMap id="shareword" type="com.sw.plugins.usercenter.socialization.shareword.entity.Shareword"/>
	
	<!-- 分享语结果集 -->
	<resultMap id="sharewordResult" type="com.sw.plugins.usercenter.socialization.shareword.entity.Shareword">
		<id property="id" column="ID" />
		<result property="title" column="Title" />
		<result property="code" column="Code" />
		<result property="content" column="Content" />
	</resultMap>
	
	<!-- 新建分享语 -->
	<insert id="insert" parameterMap="shareword">
		insert into UC_ShareWord
		<trim prefix="(" prefixOverrides="," suffix=")">
			<if test="title !=null and title !=''">,Title</if>
			<if test="code !=null and code !=''">,Code</if>
			<if test="content !=null and content !=''">,Content</if>
		</trim>
		values
		<trim prefix="(" prefixOverrides="," suffix=")">
			<if test="title !=null and title !=''">,#{title}</if>
			<if test="code !=null and code !=''">,#{code}</if>
			<if test="content !=null and content !=''">,#{content}</if>
		</trim>
	</insert>
	
	<!-- 更新分享语 -->
	<update id="update" parameterMap="shareword">
		update UC_ShareWord
		<set>			
			<trim prefixOverrides=",">
				<if test="title !=null and title !=''">,Title = #{title}</if>
				<if test="code !=null and code !=''">,Code = #{code}</if>
				,Content = #{content}
			</trim>
		</set>
		where ID=${id}
	</update>
	
	<!-- 更新分享语 -->
	<update id="update_by_code" parameterMap="shareword">
		update UC_ShareWord
		<set>			
			<trim prefixOverrides=",">
				<if test="title !=null and title !=''">,Title = #{title}</if>
				<if test="content !=null and content !=''">,Content = #{content}</if>
			</trim>
		</set>
		where Code=#{code}
	</update>
	
	<!-- 分享语通用查询 -->
	<select id="select" resultMap="sharewordResult" parameterMap="shareword">
		select 
		sico.ID, 
		sico.Title, 
		sico.Code, 
		sico.Content
	    from UC_ShareWord sico
		<where>
			<trim prefixOverrides="and">
				<if test="id!=null and id!=''">
			 	 and sico.ID=${id}
				</if>
				<if test="code !=null and code !=''">
			 	 and sico.Code=#{code}
				</if>
			</trim>
		</where>
	</select>

	
	<!-- 分享语统计查询 -->
	<select id="count" resultType="long" parameterMap="shareword">
		select count(id) from UC_ShareWord
		<where>
			<trim prefixOverrides="and">
				<if test="code !=null and code!=''">
			 	 and Code = #{code}
				</if>
			</trim>
		</where>
	</select>
	
	
	<!-- 分享语统计查询 -->
	<select id="count_by_code" resultType="Long" parameterMap="shareword">
		select count(id) from UC_ShareWord where Code = #{code};
	</select>
	
	<!-- 分享语分页查询 -->
	<select id="select_paginated" resultMap="sharewordResult" parameterMap="shareword">
		select 
		sico.ID, 
		sico.Title, 
		sico.Code,
		sico.Content
		from UC_ShareWord sico
		<where>
			<trim prefixOverrides="and">
				<if test="title!=null and title!=''">
			 	 and Title like CONCAT('%',#{title},'%')
				</if>
			</trim>
		</where>
		<if test="databaseType!=null and databaseType == 'mysql'">
			order by ID desc limit ${start},${offset}
		</if>
	</select>

	<!-- 删除分享语 -->
	<delete id="delete" parameterMap="shareword">
		delete from UC_ShareWord where ID=${id}
	</delete>
	
</mapper>
